# "org" ensures this Service is used with the correct Serverless Framework Access Key.
org: madcamp
# "service" is the name of this project. This will also be added to your AWS resource names.
service: me


provider:
  name: aws
  runtime: nodejs20.x
  region: ap-northeast-2  # 서울 리전
  
  vpc:
    securityGroupIds:
      - sg-07eacae6d3855c5fb
    subnetIds:
      - subnet-0dcf230a97d2f9420
      - subnet-00b5a3ea6c6e205b5
      - subnet-045b84f9deb5c8e1d
      - subnet-0524571fc57e5ec69
  
  
  iamRoleStatements:
    - Effect: "Allow"
      Action:
        - "rds:*"
        - "secretsmanager:GetSecretValue"
      Resource: "*"

functions:
  getAllQuestions:
    handler: handlers/getAllQuestions.getAllQuestions
    events:
      - httpApi:
          path: /questions
          method: get

  registerUser:
    handler: handlers/registerUser.registerUser
    events:
      - httpApi:
          path: /users
          method: post

  login:
    handler: handlers/login.login
    events:
      - httpApi:
          path: /login
          method: post
  getProtectedData:
    handler: handlers/getProtectedData.getProtectedData
    events:
      - http:
          path: /protected
          method: get
plugins:
  - serverless-offline
  - serverless-dotenv-plugin
